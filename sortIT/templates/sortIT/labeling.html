{% extends 'base.html' %}

{% block content %}

<ul>
    {% for is in ImageSet.objects.all %}
        <li><a href="{% url 'sortIT:labeling/{{ is.id }}' %}">{{ is.name }}</a></li>
    {% endfor %}
</ul>


<div class="row">
	<div>
        <p class="h4">{{ image_set.name }} <!--<small class="text-muted">  {{ image_set.description }}</small>--></p>
    </div>

	<div class="row my-2">
		<div class="col">
		    <span class="progress">
			<span class="progress-bar" role="progressbar" style="width: {{ progress }}%" aria-valuenow="{{ progress }}" aria-valuemin="0" aria-valuemax="100"></span>
		    </span>
		</div>
		<div class='col'>
			{{ n_labeled }}/{{ n_total }}
		</div>
	</div>

</div>

<figure class="figure m-3">
    <img src="{% url 'sortIT:show_img' image.id %}" alt="{{ image.image_set }}" class="img-fluid rounded">
    <figcaption class="figure-caption text-end">{{image.id}}</figcaption>

</figure>

<form action="{% url 'sortIT:label_post' %}" method="post" id="labeling-form">
    {% csrf_token %}

    <div class="row y-3">
        <input type="hidden" name="image" value="{{ image.id }}">
    </div>

    <div class="row m-2">
            <div class="col-lg-12 col-md-12">
                <div class="btn-group btn-group-lg panel panel-default" role="group">
                {% for label in labels %}
                    <button type="button" class="btn btn-outline-primary" data-label="{{ label.id }}" accesskey="{{ forloop.counter }}"><span class="num">{{ forloop.counter }}. </span>{{ label.name }}</button>
                {% endfor %}

                {% if not labels %}
                    <div class="alert alert-warning" role="alert">
                        No labels available. Please add labels in the <a href="/admin/sortIT/label/add/" target="_blank">admin panel</a>.

                    </div>
                {% endif %}
                </div>
            </div>
            <input type="hidden" name="label" id="label-input">

    </div>
    <div class='row m-3'>
	    <p><em>
            Alt + Number to select the item.
        </em></p>
    </div>

</form>

<style>
    @media (max-width: 768px) {
  .btn-group {
    display: none; /* Hide button group */
  }
  .panel {
    display: flex; /* Make panel a flexbox */
    flex-direction: column; /* Stack panel elements vertically */
    width: 100%; /* Make panel full width */
    height: auto; /* Set panel height to auto */
    border: none; /* Remove panel border */
  }
  .panel > button {
    display: block; /* Show buttons inside panel */
    width: 100%; /* Make buttons full width */
    height: auto; /* Set button height to auto */
    line-height: 50px; /* Center text vertically in buttons */
    text-align: center; /* Center text horizontally in buttons */
    margin-bottom: 1; /* Remove spacing between buttons */
  }
  .num {
    display: none;
  }
}


</style>

<script>
var buttons = document.querySelectorAll('.btn');
var form = document.getElementById('labeling-form');
var input = document.getElementById('label-input');
for (var i = 0; i < buttons.length; i++) {
  buttons[i].addEventListener('click', function() {
    var label = this.dataset.label;
    input.value = label;
    form.submit();
  });
}
</script>

{% endblock %}
